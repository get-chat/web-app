stages:
  - test


variables:
  NODE_IMAGE: node:16-alpine


cache:
  key:
    files:
      # compute our cache key from the lock file (`package-lock.json`)
      - package-lock.json
  paths:
    # cache `node_modules/` between our CI/CD pipeline runs, to optimize execution time
    - node_modules/


Test:
  stage: test
  image: $NODE_IMAGE

  only:
    - master
    - merge_requests
    - tags

  script:
    - npm install --prefer-offline --no-audit --no-fund
    - npm test -- --passWithNoTests
